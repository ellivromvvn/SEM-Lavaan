<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Orville Hombrebueno">

<title>Chapter 2: Multi-Factor Models</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="chapter2_files/libs/clipboard/clipboard.min.js"></script>
<script src="chapter2_files/libs/quarto-html/quarto.js"></script>
<script src="chapter2_files/libs/quarto-html/popper.min.js"></script>
<script src="chapter2_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="chapter2_files/libs/quarto-html/anchor.min.js"></script>
<link href="chapter2_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="chapter2_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="chapter2_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="chapter2_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="chapter2_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Chapter 2: Multi-Factor Models</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Orville Hombrebueno </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<p>In this chapter, you will expand your skills in lavaan to creating multi-factor models. We will improve the one-factor models from the last chapter by creating multiple latent variables in the classic Holzinger and Swineford (1939) dataset.</p>
<section id="create-a-zero-df-model" class="level1">
<h1>Create a Zero df Model</h1>
<p>In the first chapter, we created a model of text-speed from the <code>HolzingerSwineford1939</code> dataset with six manifest variables <code>x4</code>, <code>x5</code>, <code>x6</code>, <code>x7</code>, <code>x8</code>, <code>x9</code>. Create a model of only reading comprehension with <code>x4</code>, <code>x5</code>, and <code>x6</code>.</p>
<p>This model should have zero degrees of freedom because it is not identified, as we are estimating as many parameters as we have options with only three manifest variables. Analyze the model to find zero degrees of freedom. <code>lavaan</code> and the <code>HolzingerSwineford1939</code> dataset have been loaded for you.</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Instructions
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Name your model <code>text.model</code> and your latent variable <code>text</code>.</li>
<li>Use variables <code>x4</code>, <code>x5</code>, and <code>x6</code> as the manifest variables.</li>
<li>Use the <code>cfa()</code> function to analyze the model.</li>
<li>Use the <code>summary()</code> function to view the degrees of freedom.</li>
</ul>
</div>
</div>
</section>
<section id="fix-the-zero-df-model" class="level1">
<h1>Fix the Zero df Model</h1>
<p>Identification is a core component in SEM models and you should have at least one degree of freedom for any model. Using the <code>text.model</code> from the last exercise, update the model to create a degree of freedom.</p>
<p>You should label two of the coefficient paths to <code>a</code> to set them equal to each other. <code>lavaan</code> and the <code>HolzingerSwineford1939</code> dataset have been loaded for you.</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Instructions
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Update the <code>text.model</code> to have <code>x5</code> and <code>x6</code> paths both set to <code>a</code>.</li>
<li>Analyze the model with the <code>cfa()</code> function.</li>
<li>View the updated model with the <code>summary()</code> function.</li>
</ul>
</div>
</div>
</section>
<section id="build-a-multi-factor-model" class="level1">
<h1>Build a Multi-Factor Model</h1>
<p>Another way to improve our text-speed model would be to create a two-factor model with <code>text</code> and <code>speed</code> as latent variables, rather than split the model into two one-factor models. In this exercise, write the model specification code for a two-factor model.</p>
<p>If you want to view the dataset to see the columns, you can use <code>head(HolzingerSwineford1939)</code>.</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Instructions
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Name your model <code>twofactor.model</code>.</li>
<li>Use <code>x4</code>, <code>x5</code>, and <code>x6</code> to create a <code>text</code> latent variable.</li>
<li>Use <code>x7</code>, <code>x8</code>, and <code>x9</code> to create a <code>speed</code> latent variable.</li>
</ul>
</div>
</div>
</section>
<section id="summarize-the-multi-factor-model" class="level1">
<h1>Summarize the Multi-Factor Model</h1>
<p>You have now created a two-factor model of the reading comprehension and speeded addition factors. Is that better than a one-factor model? Use the <code>cfa()</code> and <code>summary()</code> functions on your new two-factor model of the <code>HolzingerSwineford1939</code> dataset to show the fit indices.</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Instructions
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Save your model fit as <code>twofactor.fit</code> using the <code>cfa()</code> function.</li>
<li>Use the <code>summary()</code> function to view the fitted model.</li>
<li>Compare the fit indices from the one-factor model to the updated model.</li>
</ul>
</div>
</div>
<p>#Three-Factor Model with Zero Correlation</p>
<p>In this exercise, you will use the Eysenck Personality Inventory dataset from the <code>psychTools</code> library to create a three-factor model of personality. This inventory includes 57 questions that measure extraversion, neuroticism, and lying.</p>
<p>Let’s create a three factor model using the latent variables: <code>extraversion</code>, <code>neuroticism</code>, and <code>lying</code> with four manifest variables on each item. Remember when you create multiple latent variables, these endogenous variables are automatically correlated. Set the correlation between the <code>extraversion</code> latent variable and <code>neuroticism</code> latent variable to zero, by using the <code>~~</code> in model specification code.</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Instructions 1/3
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Create a lying factor including items <code>V6</code>, <code>V12</code>, <code>V18</code>, and <code>V24</code>.</li>
<li>Set the correlation between <code>extraversion</code> and <code>neuroticism</code> to zero (in that order).</li>
</ul>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Instructions 2/3
</div>
</div>
<div class="callout-body-container callout-body">
<p>Analyze the three-factor model with the <code>cfa()</code> function.</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Instructions 3/3
</div>
</div>
<div class="callout-body-container callout-body">
<p>Summarize the three-factor model and look for the zero-correlation you set in the model specification.</p>
</div>
</div>
</section>
<section id="create-a-direct-path" class="level1">
<h1>Create a Direct Path</h1>
<p>In this exercise, edit the <code>epi.model</code> to include a direct regression path between <code>lying</code> and <code>neuroticism</code>. We might expect that a person’s level of neuroticism would predict their level of lying.</p>
<p>You can edit the model specification provided to include this path, and you can use the same model specification code that you might use when defining a regression in <code>lm</code>.</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Instructions 1/3
</div>
</div>
<div class="callout-body-container callout-body">
<p>Add a new line to the model specification code where lying is predicted by neuroticism.</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Instructions 2/3
</div>
</div>
<div class="callout-body-container callout-body">
<p>Complete the <code>cfa()</code> function to analyze your new model.</p>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Instructions 3/3
</div>
</div>
<div class="callout-body-container callout-body">
<p>Summarize the new model to see that the output has changed to a regression.</p>
</div>
</div>
</section>
<section id="check-model-variance" class="level1">
<h1>Check Model Variance</h1>
<p>In order to evaluate your three-factor model of the <code>epi</code>, you can examine the variance of the manifest variables to check for potential problems with the model. Very large variances can indicate potential issues; however, this value should be compared to the original scale of the data.</p>
<p>Use the <code>var()</code> function on <code>V1</code> to compare the variance of the original manifest variable to the estimated variance in your summary output. The libraries, model, and datasets have been loaded for you.</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Instructions
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Use <code>var()</code> on <code>V1</code> to calculate the variance of the original manifest variable in the <code>epi</code> dataset.</li>
<li>Compare this value to the <code>V1</code> variance estimate of the model.</li>
</ul>
</div>
</div>
</section>
<section id="examine-modification-indices" class="level1">
<h1>Examine Modification Indices</h1>
<p>The fit indices for our <code>epi.model</code> are low (in the .70s) for CFI and TLI. You can use modification indices to find potential parameters (paths) to add to the model specification to improve model fit.</p>
<p>Examine the modification indices for the <code>epi.model</code> and add the path with the largest <code>mi</code> to your model. The libraries and model have been loaded for you. After you edit your model, rerun the model summary to examine the change in fit indices.</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Instructions 1/3
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Use <code>modificationindices()</code> on the <code>epi.fit</code> to find the <code>mi</code> values.</li>
<li>Use <code>sort = TRUE</code> to see the highest values first.</li>
</ul>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Instructions 2/3
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Update the model specification code to include the largest <code>mi</code> value.</li>
</ul>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Instructions 3/3
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Reanalyze the model with the updated model specification to see how your fit indices improved.</li>
<li>Use <code>epi.model2</code> from the previous step as your model name.</li>
</ul>
</div>
</div>
</section>
<section id="compare-two-models" class="level1">
<h1>Compare Two Models</h1>
<p>In the last exercises, you created two models of the <code>epi</code>, and these models have been loaded for you.</p>
<p>The original model <code>epi.model</code> and the updated model with the modified path <code>epi.model1</code> can now be compared using the <code>anova()</code> function to determine if the change in fit indices was a large change. We can use the <code>anova()</code> function because these models are nested, which means they are the same manifest variables with different parameters.</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Instructions
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Analyze both models with the <code>cfa()</code> function and the <code>epi</code> dataset.</li>
<li>Use the <code>anova()</code> function to compare these models.</li>
</ul>
</div>
</div>
</section>
<section id="select-specific-fit-indices" class="level1">
<h1>Select Specific Fit Indices</h1>
<p>You can also compare models by using the AIC or ECVI fit indices, rather than the <code>anova()</code> function. These fit indices are very useful if your models include different manifest variables. When comparing sets of AIC or ECVI values, the best model would have the smallest fit index. The saved models from the previous exercise have been loaded for you.</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Instructions
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Use <code>fitmeasures()</code> to calculate the fit indices for each model separately.</li>
<li>Select only the <code>aic</code> and <code>ecvi</code> fit indices to shorten the output.</li>
</ul>
</div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>